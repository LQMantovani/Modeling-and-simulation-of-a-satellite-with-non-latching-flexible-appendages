function [Cq_i, Cq_j, Cqf] = constraint_fixed(Ai, Aj, Q1, Q2, wi, wj)
%Function to constraint a rotational degrees of freedom
%ai: vectors defined in the fisrt body (a_x, a_y, a_z). Dimensions 3x3
%aj: vectors defined in the second body, it is parallel to ai in the inertial system (a_x, a_y, a_z). Dimensions 3x3
%Q1: Quaternions of the first body
%Q2: Quaternions of the second body
%wi: Angular velocity of the fisrt body in the first body reference frame
%wj: Angular velocity of the fisrt body in the second body reference frame



Cq_i = zeros(3,3);
Cq_j = zeros(3,3);
Cqf = zeros(3,1);

for i = 1:3
    ai = Ai(:,i);
    aj = Aj(:,i);
    
    CqB1 = [2.*(ai(1,1).*Q1(1,1)+ai(2,1).*Q1(2,1)+ai(3,1).*Q1(3,1)).*( ...
        2.*aj(3,1).*(Q2(1,1).*Q2(3,1)+Q2(2,1).*Q2(4,1))+2.*aj(2,1).* ...
        (Q2(1,1).*Q2(2,1)+(-1).*Q2(3,1).*Q2(4,1))+aj(1,1).*(Q2(1,1) ...
        .^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+(-2).*( ...
        ai(2,1).*Q1(1,1)+(-1).*ai(1,1).*Q1(2,1)+ai(3,1).*Q1(4,1)).*( ...
        2.*aj(3,1).*(Q2(2,1).*Q2(3,1)+(-1).*Q2(1,1).*Q2(4,1))+2.*aj( ...
        1,1).*(Q2(1,1).*Q2(2,1)+Q2(3,1).*Q2(4,1))+aj(2,1).*((-1).* ...
        Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+2.*((-1) ...
        .*ai(3,1).*Q1(1,1)+ai(1,1).*Q1(3,1)+ai(2,1).*Q1(4,1)).*(2.* ...
        aj(2,1).*(Q2(2,1).*Q2(3,1)+Q2(1,1).*Q2(4,1))+2.*aj(1,1).*( ...
        Q2(1,1).*Q2(3,1)+(-1).*Q2(2,1).*Q2(4,1))+aj(3,1).*((-1).*Q2( ...
        1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)),2.*(ai(2,1) ...
        .*Q1(1,1)+(-1).*ai(1,1).*Q1(2,1)+ai(3,1).*Q1(4,1)).*(2.*aj( ...
        3,1).*(Q2(1,1).*Q2(3,1)+Q2(2,1).*Q2(4,1))+2.*aj(2,1).*(Q2(1, ...
        1).*Q2(2,1)+(-1).*Q2(3,1).*Q2(4,1))+aj(1,1).*(Q2(1,1).^2+( ...
        -1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+2.*(ai(1,1).* ...
        Q1(1,1)+ai(2,1).*Q1(2,1)+ai(3,1).*Q1(3,1)).*(2.*aj(3,1).*( ...
        Q2(2,1).*Q2(3,1)+(-1).*Q2(1,1).*Q2(4,1))+2.*aj(1,1).*(Q2(1, ...
        1).*Q2(2,1)+Q2(3,1).*Q2(4,1))+aj(2,1).*((-1).*Q2(1,1).^2+Q2( ...
        2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+(-2).*(ai(3,1).*Q1(2, ...
        1)+(-1).*ai(2,1).*Q1(3,1)+ai(1,1).*Q1(4,1)).*(2.*aj(2,1).*( ...
        Q2(2,1).*Q2(3,1)+Q2(1,1).*Q2(4,1))+2.*aj(1,1).*(Q2(1,1).*Q2( ...
        3,1)+(-1).*Q2(2,1).*Q2(4,1))+aj(3,1).*((-1).*Q2(1,1).^2+(-1) ...
        .*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)),(-2).*((-1).*ai(3,1).* ...
        Q1(1,1)+ai(1,1).*Q1(3,1)+ai(2,1).*Q1(4,1)).*(2.*aj(3,1).*( ...
        Q2(1,1).*Q2(3,1)+Q2(2,1).*Q2(4,1))+2.*aj(2,1).*(Q2(1,1).*Q2( ...
        2,1)+(-1).*Q2(3,1).*Q2(4,1))+aj(1,1).*(Q2(1,1).^2+(-1).*Q2( ...
        2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+2.*(ai(3,1).*Q1(2,1)+( ...
        -1).*ai(2,1).*Q1(3,1)+ai(1,1).*Q1(4,1)).*(2.*aj(3,1).*(Q2(2, ...
        1).*Q2(3,1)+(-1).*Q2(1,1).*Q2(4,1))+2.*aj(1,1).*(Q2(1,1).* ...
        Q2(2,1)+Q2(3,1).*Q2(4,1))+aj(2,1).*((-1).*Q2(1,1).^2+Q2(2,1) ...
        .^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+2.*(ai(1,1).*Q1(1,1)+ai(2, ...
        1).*Q1(2,1)+ai(3,1).*Q1(3,1)).*(2.*aj(2,1).*(Q2(2,1).*Q2(3, ...
        1)+Q2(1,1).*Q2(4,1))+2.*aj(1,1).*(Q2(1,1).*Q2(3,1)+(-1).*Q2( ...
        2,1).*Q2(4,1))+aj(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+ ...
        Q2(3,1).^2+Q2(4,1).^2)),2.*((ai(3,1).*Q1(2,1)+(-1).*ai(2,1) ...
        .*Q1(3,1)+ai(1,1).*Q1(4,1)).*(2.*aj(3,1).*(Q2(1,1).*Q2(3,1)+ ...
        Q2(2,1).*Q2(4,1))+2.*aj(2,1).*(Q2(1,1).*Q2(2,1)+(-1).*Q2(3, ...
        1).*Q2(4,1))+aj(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2( ...
        3,1).^2+Q2(4,1).^2))+((-1).*ai(3,1).*Q1(1,1)+ai(1,1).*Q1(3, ...
        1)+ai(2,1).*Q1(4,1)).*(2.*aj(3,1).*(Q2(2,1).*Q2(3,1)+(-1).* ...
        Q2(1,1).*Q2(4,1))+2.*aj(1,1).*(Q2(1,1).*Q2(2,1)+Q2(3,1).*Q2( ...
        4,1))+aj(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1) ...
        .^2+Q2(4,1).^2))+(ai(2,1).*Q1(1,1)+(-1).*ai(1,1).*Q1(2,1)+ ...
        ai(3,1).*Q1(4,1)).*(2.*aj(2,1).*(Q2(2,1).*Q2(3,1)+Q2(1,1).* ...
        Q2(4,1))+2.*aj(1,1).*(Q2(1,1).*Q2(3,1)+(-1).*Q2(2,1).*Q2(4, ...
        1))+aj(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+ ...
        Q2(4,1).^2)))];
    
    CqB2 = [2.*(2.*ai(3,1).*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1))+2.*ai( ...
        2,1).*(Q1(1,1).*Q1(2,1)+(-1).*Q1(3,1).*Q1(4,1))+ai(1,1).*( ...
        Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2)).*( ...
        aj(1,1).*Q2(1,1)+aj(2,1).*Q2(2,1)+aj(3,1).*Q2(3,1))+2.*(2.* ...
        ai(2,1).*(Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1))+2.*ai(1,1).*( ...
        Q1(1,1).*Q1(3,1)+(-1).*Q1(2,1).*Q1(4,1))+ai(3,1).*((-1).*Q1( ...
        1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2)).*((-1).*aj( ...
        3,1).*Q2(1,1)+aj(1,1).*Q2(3,1)+aj(2,1).*Q2(4,1))+(-2).*(2.* ...
        ai(3,1).*(Q1(2,1).*Q1(3,1)+(-1).*Q1(1,1).*Q1(4,1))+2.*ai(1, ...
        1).*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1))+ai(2,1).*((-1).*Q1( ...
        1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2)).*(aj(2,1).* ...
        Q2(1,1)+(-1).*aj(1,1).*Q2(2,1)+aj(3,1).*Q2(4,1)),2.*(2.*ai( ...
        3,1).*(Q1(2,1).*Q1(3,1)+(-1).*Q1(1,1).*Q1(4,1))+2.*ai(1,1).* ...
        (Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1))+ai(2,1).*((-1).*Q1(1,1) ...
        .^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2)).*(aj(1,1).*Q2( ...
        1,1)+aj(2,1).*Q2(2,1)+aj(3,1).*Q2(3,1))+(-2).*(2.*ai(2,1).*( ...
        Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1))+2.*ai(1,1).*(Q1(1,1).*Q1( ...
        3,1)+(-1).*Q1(2,1).*Q1(4,1))+ai(3,1).*((-1).*Q1(1,1).^2+(-1) ...
        .*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2)).*(aj(3,1).*Q2(2,1)+(-1) ...
        .*aj(2,1).*Q2(3,1)+aj(1,1).*Q2(4,1))+2.*(2.*ai(3,1).*(Q1(1, ...
        1).*Q1(3,1)+Q1(2,1).*Q1(4,1))+2.*ai(2,1).*(Q1(1,1).*Q1(2,1)+ ...
        (-1).*Q1(3,1).*Q1(4,1))+ai(1,1).*(Q1(1,1).^2+(-1).*Q1(2,1) ...
        .^2+(-1).*Q1(3,1).^2+Q1(4,1).^2)).*(aj(2,1).*Q2(1,1)+(-1).* ...
        aj(1,1).*Q2(2,1)+aj(3,1).*Q2(4,1)),2.*(2.*ai(2,1).*(Q1(2,1) ...
        .*Q1(3,1)+Q1(1,1).*Q1(4,1))+2.*ai(1,1).*(Q1(1,1).*Q1(3,1)+( ...
        -1).*Q1(2,1).*Q1(4,1))+ai(3,1).*((-1).*Q1(1,1).^2+(-1).*Q1( ...
        2,1).^2+Q1(3,1).^2+Q1(4,1).^2)).*(aj(1,1).*Q2(1,1)+aj(2,1).* ...
        Q2(2,1)+aj(3,1).*Q2(3,1))+2.*(2.*ai(3,1).*(Q1(2,1).*Q1(3,1)+ ...
        (-1).*Q1(1,1).*Q1(4,1))+2.*ai(1,1).*(Q1(1,1).*Q1(2,1)+Q1(3, ...
        1).*Q1(4,1))+ai(2,1).*((-1).*Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1( ...
        3,1).^2+Q1(4,1).^2)).*(aj(3,1).*Q2(2,1)+(-1).*aj(2,1).*Q2(3, ...
        1)+aj(1,1).*Q2(4,1))+(-2).*(2.*ai(3,1).*(Q1(1,1).*Q1(3,1)+ ...
        Q1(2,1).*Q1(4,1))+2.*ai(2,1).*(Q1(1,1).*Q1(2,1)+(-1).*Q1(3, ...
        1).*Q1(4,1))+ai(1,1).*(Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1( ...
        3,1).^2+Q1(4,1).^2)).*((-1).*aj(3,1).*Q2(1,1)+aj(1,1).*Q2(3, ...
        1)+aj(2,1).*Q2(4,1)),2.*((2.*ai(3,1).*(Q1(1,1).*Q1(3,1)+Q1( ...
        2,1).*Q1(4,1))+2.*ai(2,1).*(Q1(1,1).*Q1(2,1)+(-1).*Q1(3,1).* ...
        Q1(4,1))+ai(1,1).*(Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1) ...
        .^2+Q1(4,1).^2)).*(aj(3,1).*Q2(2,1)+(-1).*aj(2,1).*Q2(3,1)+ ...
        aj(1,1).*Q2(4,1))+(2.*ai(3,1).*(Q1(2,1).*Q1(3,1)+(-1).*Q1(1, ...
        1).*Q1(4,1))+2.*ai(1,1).*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)) ...
        +ai(2,1).*((-1).*Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1( ...
        4,1).^2)).*((-1).*aj(3,1).*Q2(1,1)+aj(1,1).*Q2(3,1)+aj(2,1) ...
        .*Q2(4,1))+(2.*ai(2,1).*(Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1))+ ...
        2.*ai(1,1).*(Q1(1,1).*Q1(3,1)+(-1).*Q1(2,1).*Q1(4,1))+ai(3, ...
        1).*((-1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1) ...
        .^2)).*(aj(2,1).*Q2(1,1)+(-1).*aj(1,1).*Q2(2,1)+aj(3,1).*Q2( ...
        4,1)))];
    
    GB1 = [(1/2).*Q1(4,1),(-1/2).*Q1(3,1),(1/2).*Q1(2,1);(1/2).*Q1(3,1),( ...
        1/2).*Q1(4,1),(-1/2).*Q1(1,1);(-1/2).*Q1(2,1),(1/2).*Q1(1,1),(1/2) ...
        .*Q1(4,1);(-1/2).*Q1(1,1),(-1/2).*Q1(2,1),(-1/2).*Q1(3,1)];
    
    GB2 = [(1/2).*Q2(4,1),(-1/2).*Q2(3,1),(1/2).*Q2(2,1);(1/2).*Q2(3,1),( ...
        1/2).*Q2(4,1),(-1/2).*Q2(1,1);(-1/2).*Q2(2,1),(1/2).*Q2(1,1),(1/2) ...
        .*Q2(4,1);(-1/2).*Q2(1,1),(-1/2).*Q2(2,1),(-1/2).*Q2(3,1)];
    
    CdqqpdqB1 = [(1/2).*((-4).*(ai(2,1).*((-1).*aj(3,1).*(2.*(Q1(3,1).*Q2(1,1)+( ...
  -1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2( ...
  2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(4,1).*Q2(2,1)+Q1(1,1) ...
  .*Q2(3,1))+2.*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+ ...
  Q1(3,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2) ...
  )+aj(2,1).*(2.*Q2(2,1).*((-1).*Q1(3,1).*Q2(1,1)+Q1(1,1).*Q2(3,1))+ ...
  2.*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*((-1).* ...
  Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai(3,1).*(aj( ...
  2,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1(4,1) ...
  .*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+( ...
  -1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1) ...
  .*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2(3,1))+(-2).*(Q1(4,1).*Q2(2, ...
  1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+(-1).*Q2(2,1) ...
  .^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*(Q1(2,1).*Q2(1,1)+( ...
  -1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2( ...
  2,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1) ...
  .^2+Q2(4,1).^2)))).*wi(1)+4.*(ai(1,1).*((-1).*aj(3,1).*(2.*(Q1(3, ...
  1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+ ...
  Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(4,1).*Q2( ...
  2,1)+Q1(1,1).*Q2(3,1))+2.*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2(3,1) ...
  ).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).* ...
  Q2(4,1).^2))+aj(2,1).*(2.*Q2(2,1).*((-1).*Q1(3,1).*Q2(1,1)+Q1(1,1) ...
  .*Q2(3,1))+2.*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1) ...
  .*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai( ...
  3,1).*(aj(1,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+ ...
  2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*( ...
  Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(2,1) ...
  .*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).* ...
  Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1) ...
  .^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*(Q1(1,1) ...
  .*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2(1,1)+ ...
  Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2, ...
  1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(2)+(-4).*(ai(2,1).*(aj(1,1).*( ...
  2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1) ...
  .*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(2,1).*(2.*Q2(2,1).*( ...
  Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1( ...
  1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).* ...
  Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2(1,1)+Q1(1,1).*Q2(2,1)).* ...
  Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2( ...
  4,1).^2)))+(-1).*ai(1,1).*(aj(2,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1) ...
  +Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2( ...
  4,1).^2))+aj(1,1).*(2.*Q2(1,1).*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).* ...
  Q2(3,1))+(-2).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2, ...
  1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj( ...
  3,1).*(2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+2.*( ...
  Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1, ...
  1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(3)+4.*(ai(3, ...
  1).*(aj(2,1).*(2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3, ...
  1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1, ...
  1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3,1).*(2.* ...
  Q2(2,1).*((-1).*Q1(3,1).*Q2(1,1)+Q1(1,1).*Q2(3,1))+2.*(Q1(1,1).* ...
  Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+Q2( ...
  2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai(1,1).*(aj(3,1).*((-2).* ...
  Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).* ...
  Q2(1,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+(-1).*Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*(Q1(1,1).*Q2(1, ...
  1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2(1,1)+Q1(1,1).* ...
  Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2( ...
  3,1).^2+Q2(4,1).^2)))+ai(2,1).*((-1).*aj(3,1).*(2.*Q2(2,1).*(Q1(2, ...
  1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).* ...
  Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1) ...
  .^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1, ...
  1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2( ...
  4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4, ...
  1).^2)))).*wj(1)+((-4).*ai(3,1).*(aj(1,1).*(2.*(Q1(3,1).*Q2(1,1)+( ...
  -1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2( ...
  2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2))+aj(3,1).*(2.*Q2(1,1).*(Q1(4,1).*Q2(2,1)+Q1(1,1) ...
  .*Q2(3,1))+2.*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+ ...
  Q1(3,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2) ...
  ))+(-4).*(ai(1,1).*((-1).*aj(3,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+ ...
  Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2( ...
  4,1).^2))+aj(1,1).*(2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3, ...
  1)+2.*((-1).*Q1(2,1).*Q2(1,1)+Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).* ...
  ((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))+ai(2, ...
  1).*(aj(3,1).*(2.*Q2(1,1).*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).*Q2(3, ...
  1))+2.*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1) ...
  .*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*( ...
  2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1) ...
  .*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+( ...
  -1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2))))).*wj(2)+4.*(ai(2,1).*( ...
  aj(1,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1( ...
  4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1) ...
  .^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.* ...
  Q2(1,1).*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).* ...
  Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+ai(3,1).*(aj(1,1).*(2.*Q2( ...
  2,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1))+(-2).*(Q1(1,1).* ...
  Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*Q2(1,1).*(Q1(4, ...
  1).*Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).* ...
  Q2(3,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1) ...
  .^2+(-1).*Q2(4,1).^2)))+ai(1,1).*((-1).*aj(2,1).*(2.*Q2(1,1).*(Q1( ...
  2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1) ...
  .*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+Q2(4,1).^2))+aj(1,1).*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+ ...
  Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2( ...
  4,1).^2)))).*wj(3)),2.*((-1).*((-1).*ai(2,1).*(aj(3,1).*(2.*(Q1(4, ...
  1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+ ...
  Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(2,1).*(2.*Q2(2,1).*((-1).* ...
  Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(1,1)+Q1(4,1).* ...
  Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1) ...
  .^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+( ...
  -1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2( ...
  4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4, ...
  1).^2)))+ai(3,1).*(aj(1,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1) ...
  .*Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+ ...
  Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2) ...
  )+aj(2,1).*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*( ...
  Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).* ...
  Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*( ...
  Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2( ...
  1,1)+Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(1)+(-1).*(ai(1,1).*(aj(3, ...
  1).*(2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1( ...
  3,1).*Q2(1,1)+Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2( ...
  2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(2,1).*(2.*Q2( ...
  2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(1, ...
  1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1) ...
  .^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(3,1).* ...
  Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2( ...
  3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1) ...
  .^2+Q2(4,1).^2)))+ai(3,1).*(aj(2,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1, ...
  1)+Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)) ...
  .*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).* ...
  Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1) ...
  .*Q2(3,1))+(-2).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1( ...
  2,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+ ...
  aj(3,1).*(2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+ ...
  2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*((-1).* ...
  Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(2)+(ai( ...
  1,1).*(aj(1,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+ ...
  2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*( ...
  Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(2,1) ...
  .*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).* ...
  Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1) ...
  .^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*(Q1(1,1) ...
  .*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2(1,1)+ ...
  Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2, ...
  1).^2+Q2(3,1).^2+Q2(4,1).^2)))+ai(2,1).*(aj(2,1).*(2.*Q2(2,1).*( ...
  Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1( ...
  2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2( ...
  3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*((-1).*Q1(1,1).* ...
  Q2(2,1)+Q1(4,1).*Q2(3,1))+(-2).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1) ...
  ).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+ ...
  Q2(4,1).^2))+aj(3,1).*(2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1) ...
  ).*Q2(3,1)+2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1) ...
  .*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).* ...
  wi(3)+(ai(1,1).*(aj(2,1).*(2.*((-1).*Q1(2,1).*Q2(1,1)+Q1(1,1).*Q2( ...
  2,1)).*Q2(3,1)+(-2).*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+ ...
  Q1(4,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2) ...
  )+aj(3,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*( ...
  Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1, ...
  1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+ai(3,1).*( ...
  aj(2,1).*(2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1) ...
  .*Q1(3,1).*Q2(1,1)+Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1) ...
  .^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3,1).*(2.* ...
  Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).* ...
  Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+ai(2,1).*(aj(3,1).*((-2).* ...
  Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).* ...
  Q2(1,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+(-1).*Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*(Q1(1,1).*Q2(1, ...
  1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2(1,1)+Q1(1,1).* ...
  Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2( ...
  3,1).^2+Q2(4,1).^2)))).*wj(1)+(ai(2,1).*(aj(1,1).*((-2).*(Q1(1,1) ...
  .*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(2,1).*Q2(1,1)+(-1).* ...
  Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2( ...
  2,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1) ...
  ).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+ ...
  Q2(4,1).^2)))+ai(3,1).*((-1).*aj(1,1).*(2.*(Q1(4,1).*Q2(1,1)+Q1(3, ...
  1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+Q1(4,1).*Q2(2,1)) ...
  .*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).* ...
  Q2(4,1).^2))+aj(3,1).*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1) ...
  .*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1) ...
  .*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai( ...
  1,1).*(aj(3,1).*(2.*Q2(1,1).*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).*Q2( ...
  3,1))+2.*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*(( ...
  -1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).* ...
  (2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1) ...
  .*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+( ...
  -1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wj(2)+((-1).*ai(1,1).*( ...
  aj(1,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1( ...
  4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1) ...
  .^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.* ...
  Q2(1,1).*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).* ...
  Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+(-1).*ai(3,1).*(aj(1,1).*( ...
  2.*Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1) ...
  .*Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*Q2(1,1).*( ...
  Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1( ...
  3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+Q2(4,1).^2)))+ai(2,1).*((-1).*aj(2,1).*(2.*Q2(1,1).*( ...
  Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1( ...
  2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+Q2(4,1).^2))+aj(1,1).*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+ ...
  Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2( ...
  4,1).^2)))).*wj(3)),(1/2).*(4.*(ai(3,1).*(aj(3,1).*(2.*(Q1(4,1).* ...
  Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+Q1( ...
  4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2( ...
  3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(2,1).*(2.*Q2(2,1).*((-1).*Q1( ...
  4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2( ...
  3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+(-1).* ...
  Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+ ...
  Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2) ...
  ))+ai(2,1).*(aj(1,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2( ...
  3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1, ...
  1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj( ...
  2,1).*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*(Q1(3,1) ...
  .*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1) ...
  .^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*(Q1(1,1) ...
  .*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2,1).*Q2(1,1)+ ...
  Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2, ...
  1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(1)+(-4).*(ai(3,1).*(aj(3,1).*( ...
  2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1) ...
  .*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1) ...
  .^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*Q2(2,1).*(Q1( ...
  3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1))+(-2).*(Q1(1,1).*Q2(1,1)+Q1( ...
  3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2( ...
  3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*((-2).*Q2(1,1).*(Q1(4,1).*Q2( ...
  2,1)+Q1(1,1).*Q2(3,1))+2.*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).*Q2(3,1) ...
  ).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+ ...
  Q2(4,1).^2)))+ai(1,1).*(aj(1,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+ ...
  Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2( ...
  4,1).^2))+aj(2,1).*(2.*Q2(2,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1) ...
  )+2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*( ...
  (-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1) ...
  .*(2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(2, ...
  1).*Q2(1,1)+Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+ ...
  (-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(2)+4.*(ai(2,1).*( ...
  aj(3,1).*(2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+ ...
  2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1) ...
  .^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.* ...
  Q2(2,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1))+(-2).*(Q1(1,1) ...
  .*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*((-2).*Q2(1,1).* ...
  (Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*(Q1(1,1).*Q2(2,1)+(-1).*Q1( ...
  4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+Q2(4,1).^2)))+(-1).*ai(1,1).*(aj(3,1).*(2.*(Q1(4,1).* ...
  Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+Q1( ...
  4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2( ...
  3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(2,1).*(2.*Q2(2,1).*((-1).*Q1( ...
  4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2( ...
  3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+(-1).* ...
  Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+ ...
  Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2) ...
  ))).*wi(3)+((-4).*ai(1,1).*(aj(2,1).*(2.*(Q1(3,1).*Q2(1,1)+(-1).* ...
  Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)) ...
  .*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).* ...
  Q2(4,1).^2))+aj(3,1).*(2.*Q2(2,1).*((-1).*Q1(3,1).*Q2(1,1)+Q1(1,1) ...
  .*Q2(3,1))+2.*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1) ...
  .*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+(-4) ...
  .*(ai(2,1).*(aj(2,1).*(2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2( ...
  3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1) ...
  .*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3, ...
  1).*(2.*Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1( ...
  2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1) ...
  .*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+ai(3,1).*(aj(2,1).*(( ...
  -2).*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(2,1).*Q2( ...
  1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+Q2(2,1) ...
  .^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3,1).*(2.*Q2(2,1).*(Q1( ...
  1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1) ...
  .*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+Q2(4,1).^2))))).*wj(1)+4.*(ai(1,1).*(aj(1,1).*(2.*(Q1( ...
  3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1, ...
  1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3,1).*(2.*Q2(1,1).*(Q1(4,1).* ...
  Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2( ...
  3,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2)))+ai(3,1).*(aj(1,1).*((-2).*(Q1(1,1).*Q2(1,1)+Q1( ...
  2,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2, ...
  1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1) ...
  .*Q2(4,1).^2))+aj(3,1).*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).* ...
  Q2(3,1))+2.*((-1).*Q1(3,1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1( ...
  1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ ...
  ai(2,1).*(aj(1,1).*(2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3, ...
  1)+2.*((-1).*Q1(3,1).*Q2(1,1)+Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).* ...
  (Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+(-1).* ...
  aj(3,1).*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+ ...
  2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1) ...
  .^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))).*wj(2)+4.*( ...
  ai(2,1).*(aj(1,1).*(2.*Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).* ...
  Q2(3,1))+2.*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).* ...
  (Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1) ...
  .*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2, ...
  1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai(3,1).*((-1).*aj(2,1) ...
  .*(2.*Q2(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+2.*((-1).*Q1(3, ...
  1).*Q2(2,1)+Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(1,1).*(2.*Q2(2,1).*( ...
  Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1( ...
  1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+Q2(4,1).^2)))+ai(1,1).*(aj(2,1).*((-2).*Q2(1,1).*(Q1( ...
  4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1) ...
  .*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+Q2(4,1).^2))+aj(1,1).*(2.*Q2(2,1).*((-1).*Q1(3,1).*Q2( ...
  1,1)+Q1(1,1).*Q2(3,1))+2.*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2( ...
  4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4, ...
  1).^2)))).*wj(3)),(1/2).*(4.*(ai(3,1).*(aj(3,1).*(2.*(Q1(3,1).*Q2( ...
  1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1) ...
  .*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1) ...
  .^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*Q2(2,1).*(Q1(3,1).*Q2(1,1)+( ...
  -1).*Q1(1,1).*Q2(3,1))+(-2).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2( ...
  4,1).^2))+aj(1,1).*((-2).*Q2(1,1).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2( ...
  3,1))+2.*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3, ...
  1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ ...
  ai(2,1).*(aj(2,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1) ...
  )+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*( ...
  Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1) ...
  .*(2.*Q2(1,1).*((-1).*Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2(3,1))+(-2).*( ...
  Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+( ...
  -1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2))+aj(3,1).*(2.*(Q1(2, ...
  1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1).*Q2(1,1)+ ...
  Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2, ...
  1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(1)+(-4).*((-1).*ai(3,1).*(aj( ...
  3,1).*(2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).* ...
  Q1(3,1).*Q2(1,1)+Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+ ...
  Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(2,1).*(2.* ...
  Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).* ...
  Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2( ...
  2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(3, ...
  1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).* ...
  Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2( ...
  3,1).^2+Q2(4,1).^2)))+ai(1,1).*(aj(2,1).*(2.*Q2(2,1).*(Q1(2,1).* ...
  Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2( ...
  3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*((-1).*Q1(1,1).*Q2(2,1)+ ...
  Q1(4,1).*Q2(3,1))+(-2).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4, ...
  1)+Q1(2,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1) ...
  .^2))+aj(3,1).*(2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2( ...
  3,1)+2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*(( ...
  -1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wi(2)+ ...
  (-4).*(ai(1,1).*(aj(3,1).*(2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2( ...
  2,1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1( ...
  1,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+ ...
  aj(2,1).*(2.*Q2(2,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1))+( ...
  -2).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1, ...
  1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(( ...
  -2).*Q2(1,1).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*(Q1(1,1).*Q2( ...
  2,1)+(-1).*Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai(2,1).*(aj(3,1).*(2.*( ...
  Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2( ...
  1,1)+Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+( ...
  -1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(2,1).*(2.*Q2(2,1).*(( ...
  -1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(1,1)+Q1(4, ...
  1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3, ...
  1).^2+(-1).*Q2(4,1).^2))+aj(1,1).*(2.*Q2(1,1).*(Q1(3,1).*Q2(2,1)+( ...
  -1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)).*Q2( ...
  4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4, ...
  1).^2)))).*wi(3)+4.*(ai(1,1).*(aj(2,1).*(2.*(Q1(4,1).*Q2(1,1)+Q1( ...
  3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+Q1(4,1).*Q2(2, ...
  1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1) ...
  .*Q2(4,1).^2))+aj(3,1).*(2.*Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2, ...
  1).*Q2(3,1))+2.*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3, ...
  1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+( ...
  -1).*ai(2,1).*(aj(2,1).*(2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2, ...
  1)).*Q2(3,1)+2.*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1, ...
  1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj( ...
  3,1).*(2.*Q2(2,1).*((-1).*Q1(3,1).*Q2(1,1)+Q1(1,1).*Q2(3,1))+2.*( ...
  Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1, ...
  1).^2+Q2(2,1).^2+(-1).*Q2(3,1).^2+Q2(4,1).^2)))+ai(3,1).*((-1).* ...
  aj(3,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))+2.*(Q1( ...
  4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1) ...
  .^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*( ...
  Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1).*Q2( ...
  1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+Q1(4,1).*((-1).*Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2)))).*wj(1)+(4.*ai(2,1).*(aj(1,1) ...
  .*(2.*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1)).*Q2(3,1)+2.*(Q1(4, ...
  1).*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+Q2(2, ...
  1).^2+(-1).*Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(3,1).*(2.*Q2(1,1).*( ...
  Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*((-1).*Q1(1,1).*Q2(2,1)+Q1( ...
  4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2( ...
  3,1).^2+(-1).*Q2(4,1).^2)))+(-4).*(ai(1,1).*(aj(1,1).*(2.*(Q1(4,1) ...
  .*Q2(1,1)+Q1(3,1).*Q2(2,1)).*Q2(3,1)+2.*((-1).*Q1(3,1).*Q2(1,1)+ ...
  Q1(4,1).*Q2(2,1)).*Q2(4,1)+Q1(2,1).*(Q2(1,1).^2+Q2(2,1).^2+(-1).* ...
  Q2(3,1).^2+(-1).*Q2(4,1).^2))+(-1).*aj(3,1).*(2.*Q2(1,1).*(Q1(3,1) ...
  .*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1(3,1).* ...
  Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1).*Q2( ...
  3,1).^2+Q2(4,1).^2)))+ai(3,1).*(aj(3,1).*(2.*Q2(1,1).*(Q1(1,1).* ...
  Q2(2,1)+(-1).*Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2( ...
  3,1)).*Q2(4,1)+Q1(2,1).*((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+( ...
  -1).*Q2(4,1).^2))+aj(1,1).*(2.*(Q1(2,1).*Q2(1,1)+(-1).*Q1(1,1).* ...
  Q2(2,1)).*Q2(3,1)+2.*(Q1(1,1).*Q2(1,1)+Q1(2,1).*Q2(2,1)).*Q2(4,1)+ ...
  Q1(4,1).*((-1).*Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+Q2(4,1).^2) ...
  )))).*wj(2)+(4.*ai(3,1).*(aj(1,1).*(2.*Q2(2,1).*(Q1(2,1).*Q2(1,1)+ ...
  Q1(4,1).*Q2(3,1))+2.*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1)).* ...
  Q2(4,1)+Q1(1,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2( ...
  4,1).^2))+aj(2,1).*(2.*Q2(1,1).*(Q1(1,1).*Q2(2,1)+(-1).*Q1(4,1).* ...
  Q2(3,1))+2.*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1)).*Q2(4,1)+Q1(2,1).* ...
  ((-1).*Q2(1,1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+(-4).* ...
  (ai(2,1).*(aj(1,1).*(2.*Q2(2,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(1,1).* ...
  Q2(3,1))+(-2).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1)).*Q2(4,1)+Q1(4, ...
  1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj( ...
  2,1).*(2.*Q2(1,1).*(Q1(4,1).*Q2(2,1)+Q1(1,1).*Q2(3,1))+2.*((-1).* ...
  Q1(1,1).*Q2(2,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*((-1).*Q2(1, ...
  1).^2+Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2)))+ai(1,1).*(aj(1,1) ...
  .*(2.*Q2(2,1).*((-1).*Q1(4,1).*Q2(1,1)+Q1(2,1).*Q2(3,1))+2.*(Q1(2, ...
  1).*Q2(1,1)+Q1(4,1).*Q2(3,1)).*Q2(4,1)+Q1(3,1).*(Q2(1,1).^2+(-1).* ...
  Q2(2,1).^2+Q2(3,1).^2+(-1).*Q2(4,1).^2))+aj(2,1).*(2.*Q2(1,1).*( ...
  Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+2.*(Q1(2,1).*Q2(2,1)+Q1( ...
  3,1).*Q2(3,1)).*Q2(4,1)+Q1(4,1).*(Q2(1,1).^2+(-1).*Q2(2,1).^2+(-1) ...
  .*Q2(3,1).^2+Q2(4,1).^2))))).*wj(3))];
    
    
    CdqqpdqB2 = [(1/2).*((4.*ai(3,1).*(aj(1,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(3,1) ...
  .^2.*Q2(2,1)+(-1).*(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+2.*Q1(3, ...
  1).*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1))+(-2).*Q1(1,1) ...
  .*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(3,1).*(2.*(Q1(2,1) ...
  .*Q1(3,1)+Q1(1,1).*Q1(4,1)).*Q2(1,1)+2.*((-1).*Q1(1,1).*Q1( ...
  2,1)+Q1(3,1).*Q1(4,1)).*Q2(3,1)+((-1).*Q1(1,1).^2+Q1(2,1) ...
  .^2+(-1).*Q1(3,1).^2+Q1(4,1).^2).*Q2(4,1))+(-1).*aj(2,1).*( ...
  Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+( ...
  -1).*Q1(4,1).^2).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+ ...
  2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+ ...
  Q1(4,1).*Q2(4,1))))+4.*ai(2,1).*(aj(1,1).*(2.*(Q1(1,1).*Q1( ...
  3,1)+Q1(2,1).*Q1(4,1)).*Q2(1,1)+2.*(Q1(2,1).*Q1(3,1)+(-1).* ...
  Q1(1,1).*Q1(4,1)).*Q2(2,1)+((-1).*Q1(1,1).^2+(-1).*Q1(2,1) ...
  .^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(3,1))+aj(2,1).*(2.*((-1).*Q1( ...
  2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).*Q2(1,1)+2.*(Q1(1,1).*Q1(3, ...
  1)+Q1(2,1).*Q1(4,1)).*Q2(2,1)+((-1).*Q1(1,1).^2+(-1).*Q1(2, ...
  1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(4,1))+aj(3,1).*(Q1(1,1) ...
  .^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*(Q1(3,1).^2+Q1(4,1) ...
  .^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3,1)+(-1).*Q1(3,1).* ...
  Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))) ...
  .*wi(1)+(4.*ai(1,1).*((-2).*(aj(2,1).*((-1).*Q1(2,1).*Q1(3, ...
  1)+Q1(1,1).*Q1(4,1))+aj(1,1).*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1( ...
  4,1))).*Q2(1,1)+(-2).*(aj(1,1).*(Q1(2,1).*Q1(3,1)+(-1).*Q1( ...
  1,1).*Q1(4,1))+aj(2,1).*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1))) ...
  .*Q2(2,1)+aj(1,1).*(Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+( ...
  -1).*Q1(4,1).^2).*Q2(3,1)+aj(3,1).*(((-1).*Q1(1,1).^2+(-1).* ...
  Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(1,1)+(-2).*(Q1(1,1).* ...
  Q1(3,1)+Q1(2,1).*Q1(4,1)).*Q2(3,1))+(2.*aj(3,1).*(Q1(2,1).* ...
  Q1(3,1)+(-1).*Q1(1,1).*Q1(4,1))+aj(2,1).*(Q1(1,1).^2+Q1(2,1) ...
  .^2+(-1).*Q1(3,1).^2+(-1).*Q1(4,1).^2)).*Q2(4,1))+4.*ai(3,1) ...
  .*(aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+( ...
  -1).*Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1( ...
  4,1).*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*( ...
  Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+aj(2,1).*((-2).*Q1(1,1) ...
  .*Q1(2,1).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(1,1)+Q1(1,1) ...
  .^2.*Q2(2,1)+(-1).*Q1(2,1).^2.*Q2(2,1)+(-1).*Q1(3,1).^2.*Q2( ...
  2,1)+Q1(4,1).^2.*Q2(2,1)+2.*(Q1(1,1).*Q1(3,1)+(-1).*Q1(2,1) ...
  .*Q1(4,1)).*Q2(4,1))+aj(3,1).*((-2).*Q1(1,1).*Q1(3,1).*Q2(1, ...
  1)+2.*Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(3,1)+(-1).* ...
  Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.* ...
  Q2(3,1)+(-2).*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(4,1))) ...
  ).*wi(2)+((-4).*ai(2,1).*(aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1) ...
  .*Q1(2,1).^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.* ...
  Q2(1,1)+2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1) ...
  .*Q2(3,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+ ...
  aj(2,1).*((-2).*Q1(1,1).*Q1(2,1).*Q2(1,1)+(-2).*Q1(3,1).*Q1( ...
  4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(2,1)+(-1).*Q1(2,1).^2.*Q2(2,1)+ ...
  (-1).*Q1(3,1).^2.*Q2(2,1)+Q1(4,1).^2.*Q2(2,1)+2.*(Q1(1,1).* ...
  Q1(3,1)+(-1).*Q1(2,1).*Q1(4,1)).*Q2(4,1))+aj(3,1).*((-2).* ...
  Q1(1,1).*Q1(3,1).*Q2(1,1)+2.*Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1, ...
  1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.* ...
  Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+(-2).*(Q1(1,1).*Q1(2,1)+Q1(3,1) ...
  .*Q1(4,1)).*Q2(4,1)))+4.*ai(1,1).*(aj(1,1).*((-1).*Q1(1,1) ...
  .^2.*Q2(2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+(Q1(2,1).^2+Q1(4,1) ...
  .^2).*Q2(2,1)+Q1(3,1).*((-2).*Q1(4,1).*Q2(1,1)+2.*Q1(2,1).* ...
  Q2(3,1))+2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+ ...
  aj(3,1).*((-2).*(Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).*Q2(1,1) ...
  +2.*(Q1(1,1).*Q1(2,1)+(-1).*Q1(3,1).*Q1(4,1)).*Q2(3,1)+(Q1( ...
  1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4, ...
  1))+aj(2,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+ ...
  (Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4, ...
  1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(2, ...
  1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))).*wi(3)+4.*(ai(1,1).*(aj(2, ...
  1).*(2.*Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(3,1)+(-1).* ...
  Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.* ...
  Q2(3,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+(-2).*Q1(1,1).*(Q1( ...
  3,1).*Q2(1,1)+Q1(2,1).*Q2(4,1)))+aj(3,1).*(2.*Q1(3,1).*Q1(4, ...
  1).*Q2(1,1)+(-1).*Q1(1,1).^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+( ...
  Q1(2,1).^2+(-1).*Q1(4,1).^2).*Q2(2,1)+2.*Q1(2,1).*Q1(4,1).* ...
  Q2(4,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+(-1).*Q1(3,1).*Q2(4,1) ...
  )))+(-1).*ai(2,1).*(aj(2,1).*(2.*Q1(2,1).*(Q1(3,1).*Q2(1,1)+ ...
  (-1).*Q1(1,1).*Q2(3,1))+2.*Q1(4,1).*(Q1(1,1).*Q2(1,1)+Q1(3, ...
  1).*Q2(3,1))+((-1).*Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+ ...
  Q1(4,1).^2).*Q2(4,1))+aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).* ...
  Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))+ai(3,1).*( ...
  aj(3,1).*((-2).*Q1(1,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1)) ...
  +2.*Q1(2,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1))+(Q1( ...
  1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4, ...
  1))+aj(2,1).*(Q1(1,1).^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).* ...
  (Q1(3,1).^2+Q1(4,1).^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3, ...
  1)+(-1).*Q1(3,1).*Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1( ...
  4,1).*Q2(4,1))))).*wj(1)+(-4).*(ai(2,1).*(aj(3,1).*(Q1(1,1) ...
  .^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+(-1).*(Q1(2,1).^2+Q1(4,1) ...
  .^2).*Q2(2,1)+2.*Q1(3,1).*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).* ...
  Q2(3,1))+(-2).*Q1(1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1))) ...
  +aj(1,1).*(Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(1,1).*Q2( ...
  3,1))+(-2).*Q1(4,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+( ...
  Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).* ...
  Q2(4,1)))+(-1).*ai(1,1).*(aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+(-1) ...
  .*Q1(2,1).^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.* ...
  Q2(1,1)+2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1) ...
  .*Q2(3,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+ ...
  aj(1,1).*((-2).*Q1(2,1).*Q1(4,1).*Q2(1,1)+(-1).*Q1(1,1).^2.* ...
  Q2(3,1)+Q1(2,1).^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).* ...
  Q2(3,1)+2.*Q1(3,1).*Q1(4,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(3,1).* ...
  Q2(1,1)+Q1(2,1).*Q2(4,1))))+ai(3,1).*(aj(3,1).*((-2).*Q1(2, ...
  1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+Q1(1,1).*((-2).*Q1( ...
  3,1).*Q2(1,1)+2.*Q1(4,1).*Q2(2,1))+(Q1(1,1).^2+Q1(2,1).^2+( ...
  -1).*Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1))+aj(1,1).*(Q1(1, ...
  1).^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*(Q1(3,1).^2+Q1(4,1) ...
  .^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3,1)+(-1).*Q1(3,1).* ...
  Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))) ...
  .*wj(2)+4.*(ai(3,1).*(aj(2,1).*((-2).*Q1(2,1).*(Q1(4,1).*Q2( ...
  1,1)+Q1(3,1).*Q2(2,1))+Q1(1,1).*((-2).*Q1(3,1).*Q2(1,1)+2.* ...
  Q1(4,1).*Q2(2,1))+(Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+( ...
  -1).*Q1(4,1).^2).*Q2(3,1))+aj(1,1).*(2.*Q1(1,1).*(Q1(4,1).* ...
  Q2(1,1)+Q1(3,1).*Q2(2,1))+Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1)+ ...
  2.*Q1(4,1).*Q2(2,1))+((-1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1( ...
  3,1).^2+Q1(4,1).^2).*Q2(4,1)))+(-1).*ai(1,1).*(aj(2,1).*(Q1( ...
  1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(-1).*Q1(3,1) ...
  .^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4,1).*Q2(2, ...
  1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1(2,1).*Q2( ...
  2,1)+Q1(3,1).*Q2(3,1)))+aj(1,1).*(2.*Q1(3,1).*Q1(4,1).*Q2(1, ...
  1)+(-1).*Q1(1,1).^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+(Q1(2,1) ...
  .^2+(-1).*Q1(4,1).^2).*Q2(2,1)+2.*Q1(2,1).*Q1(4,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+(-1).*Q1(3,1).*Q2(4,1))))+ai( ...
  2,1).*(aj(2,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+( ...
  -1).*(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+2.*Q1(3,1).*(Q1(4,1).* ...
  Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1))+(-2).*Q1(1,1).*(Q1(2,1).*Q2( ...
  1,1)+Q1(4,1).*Q2(3,1)))+aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).* ...
  Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))).*wj(3)),( ...
  1/2).*((4.*ai(3,1).*(aj(2,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(3,1) ...
  .^2.*Q2(2,1)+(-1).*(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+2.*Q1(3, ...
  1).*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1))+(-2).*Q1(1,1) ...
  .*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(3,1).*(2.*Q1(1,1) ...
  .*Q1(4,1).*Q2(2,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2( ...
  3,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1)+2.*Q1(3,1).*Q1( ...
  4,1).*Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(1,1).* ...
  Q2(4,1)))+aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.* ...
  Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+(-2).*Q1(3,1) ...
  .*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+2.*Q1(1,1).* ...
  (Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))+4.*ai(2,1).*(aj(2,1).* ...
  (2.*Q1(2,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+2.*Q1(1,1) ...
  .*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1))+((-1).*Q1(1,1) ...
  .^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(3,1))+aj(1, ...
  1).*(2.*(Q1(2,1).*Q1(3,1)+(-1).*Q1(1,1).*Q1(4,1)).*Q2(1,1)+( ...
  -2).*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1)).*Q2(2,1)+(Q1(1,1) ...
  .^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1))+ ...
  aj(3,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2,1)+(-1).*(Q1( ...
  3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).*Q1(4,1).*Q2(3, ...
  1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).*Q2(3,1)+Q1(4, ...
  1).*Q2(4,1))))).*wi(1)+(4.*ai(3,1).*(aj(2,1).*(Q1(1,1).^2.* ...
  Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2(1,1)+ ...
  Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).*Q1(2, ...
  1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).* ...
  Q2(3,1)))+aj(3,1).*(2.*((-1).*Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1( ...
  4,1)).*Q2(2,1)+2.*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3, ...
  1)+(Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2) ...
  .*Q2(4,1))+aj(1,1).*(2.*Q1(3,1).*Q1(4,1).*Q2(1,1)+(-1).*Q1( ...
  1,1).^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+(Q1(2,1).^2+(-1).*Q1(4, ...
  1).^2).*Q2(2,1)+2.*Q1(2,1).*Q1(4,1).*Q2(4,1)+2.*Q1(1,1).*( ...
  Q1(2,1).*Q2(1,1)+(-1).*Q1(3,1).*Q2(4,1))))+4.*ai(1,1).*(aj( ...
  2,1).*((-2).*Q1(2,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+ ...
  Q1(1,1).*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(4,1).*Q2(2,1))+(Q1(1, ...
  1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1) ...
  )+aj(1,1).*(2.*((-1).*Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).* ...
  Q2(1,1)+2.*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1)).*Q2(2,1)+(( ...
  -1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2( ...
  4,1))+(-1).*aj(3,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2, ...
  1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).* ...
  Q1(4,1).*Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).* ...
  Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wi(2)+(4.*ai(2,1).*((-1).*aj( ...
  2,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(-1).* ...
  Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4,1) ...
  .*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1(2, ...
  1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+aj(1,1).*((-2).*Q1(1,1).*Q1( ...
  2,1).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.* ...
  Q2(2,1)+(-1).*Q1(2,1).^2.*Q2(2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+ ...
  Q1(4,1).^2.*Q2(2,1)+2.*(Q1(1,1).*Q1(3,1)+(-1).*Q1(2,1).*Q1( ...
  4,1)).*Q2(4,1))+aj(3,1).*(2.*(Q1(1,1).*Q1(3,1)+(-1).*Q1(2,1) ...
  .*Q1(4,1)).*Q2(2,1)+(-2).*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1) ...
  ).*Q2(3,1)+((-1).*Q1(1,1).^2+Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1( ...
  4,1).^2).*Q2(4,1)))+(-4).*ai(1,1).*(aj(2,1).*(Q1(1,1).^2.* ...
  Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+(-1).*(Q1(2,1).^2+Q1(4,1).^2).* ...
  Q2(2,1)+2.*Q1(3,1).*(Q1(4,1).*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1) ...
  )+(-2).*Q1(1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(3, ...
  1).*(2.*Q1(1,1).*Q1(4,1).*Q2(2,1)+Q1(1,1).^2.*Q2(3,1)+(-1).* ...
  Q1(2,1).^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1)+ ...
  2.*Q1(3,1).*Q1(4,1).*Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+( ...
  -1).*Q1(1,1).*Q2(4,1)))+aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).* ...
  Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))).*wi(3)+( ...
  -4).*(ai(1,1).*(aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1) ...
  .^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+ ...
  2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1) ...
  +2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+aj(2,1).*( ...
  2.*Q1(1,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+(-2).* ...
  Q1(4,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+((-1).*Q1(1,1) ...
  .^2+Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1)))+ai(2, ...
  1).*(aj(3,1).*((-1).*Q1(1,1).^2.*Q2(2,1)+(-1).*Q1(3,1).^2.* ...
  Q2(2,1)+(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(3,1).*((-2).*Q1( ...
  4,1).*Q2(1,1)+2.*Q1(2,1).*Q2(3,1))+2.*Q1(1,1).*(Q1(2,1).*Q2( ...
  1,1)+Q1(4,1).*Q2(3,1)))+aj(2,1).*(2.*Q1(1,1).*Q1(4,1).*Q2(2, ...
  1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2(3,1)+(Q1(3,1) ...
  .^2+(-1).*Q1(4,1).^2).*Q2(3,1)+2.*Q1(3,1).*Q1(4,1).*Q2(4,1)+ ...
  2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(1,1).*Q2(4,1))))+ai( ...
  3,1).*(aj(3,1).*(2.*Q1(2,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2( ...
  2,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1))+ ...
  ((-1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).* ...
  Q2(3,1))+(-1).*aj(2,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2( ...
  2,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).* ...
  Q1(4,1).*Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).* ...
  Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wj(1)+(-4).*(ai(1,1).*(aj(1,1) ...
  .*(Q1(1,1).*((-2).*Q1(3,1).*Q2(2,1)+2.*Q1(2,1).*Q2(3,1))+2.* ...
  Q1(4,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+(Q1(1,1).^2+( ...
  -1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2).*Q2(4,1))+aj(3, ...
  1).*((-2).*Q1(3,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(2,1)+( ...
  -1).*Q1(2,1).^2.*Q2(2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+Q1(4,1) ...
  .^2.*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(4,1)+Q1(1,1).*((-2) ...
  .*Q1(2,1).*Q2(1,1)+2.*Q1(3,1).*Q2(4,1))))+ai(2,1).*(aj(1,1) ...
  .*((-2).*Q1(1,1).*Q1(4,1).*Q2(2,1)+(-1).*Q1(1,1).^2.*Q2(3,1) ...
  +Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.* ...
  Q2(3,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+Q1(2,1).*((-2).*Q1( ...
  3,1).*Q2(2,1)+2.*Q1(1,1).*Q2(4,1)))+aj(3,1).*(Q1(1,1).^2.* ...
  Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1) ...
  .^2).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).* ...
  Q1(3,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2( ...
  4,1))))+ai(3,1).*(aj(3,1).*(2.*Q1(1,1).*(Q1(4,1).*Q2(1,1)+ ...
  Q1(3,1).*Q2(2,1))+Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(4, ...
  1).*Q2(2,1))+((-1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+ ...
  Q1(4,1).^2).*Q2(4,1))+aj(1,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1) ...
  .^2.*Q2(2,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1) ...
  .*((-2).*Q1(4,1).*Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*( ...
  Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wj(2)+4.*(ai(3,1).*( ...
  aj(1,1).*(2.*Q1(2,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+ ...
  2.*Q1(1,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1))+((-1) ...
  .*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(3, ...
  1))+aj(2,1).*(2.*Q1(1,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1) ...
  )+Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(4,1).*Q2(2,1))+(( ...
  -1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2( ...
  4,1)))+ai(1,1).*(aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1) ...
  .^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+ ...
  2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1) ...
  +2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+aj(2,1).*( ...
  (-2).*Q1(3,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(2,1)+(-1).* ...
  Q1(2,1).^2.*Q2(2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+Q1(4,1).^2.* ...
  Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(4,1)+Q1(1,1).*((-2).*Q1( ...
  2,1).*Q2(1,1)+2.*Q1(3,1).*Q2(4,1))))+ai(2,1).*(aj(1,1).*(( ...
  -1).*Q1(1,1).^2.*Q2(2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+(Q1(2,1) ...
  .^2+Q1(4,1).^2).*Q2(2,1)+Q1(3,1).*((-2).*Q1(4,1).*Q2(1,1)+ ...
  2.*Q1(2,1).*Q2(3,1))+2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).* ...
  Q2(3,1)))+aj(2,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.* ...
  Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+(-2).*Q1(3,1) ...
  .*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+2.*Q1(1,1).* ...
  (Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))).*wj(3)),(1/2).*((4.* ...
  ai(3,1).*(aj(3,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+ ...
  (-1).*(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+2.*Q1(3,1).*(Q1(4,1) ...
  .*Q2(1,1)+(-1).*Q1(2,1).*Q2(3,1))+(-2).*Q1(1,1).*(Q1(2,1).* ...
  Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(1,1).*((-2).*(Q1(2,1).*Q1(3,1) ...
  +Q1(1,1).*Q1(4,1)).*Q2(1,1)+2.*(Q1(1,1).*Q1(2,1)+(-1).*Q1(3, ...
  1).*Q1(4,1)).*Q2(3,1)+(Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1) ...
  .^2+(-1).*Q1(4,1).^2).*Q2(4,1))+aj(2,1).*((-2).*Q1(1,1).*Q1( ...
  4,1).*Q2(2,1)+(-1).*Q1(1,1).^2.*Q2(3,1)+Q1(2,1).^2.*Q2(3,1)+ ...
  (-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+(-2).*Q1(3,1) ...
  .*Q1(4,1).*Q2(4,1)+Q1(2,1).*((-2).*Q1(3,1).*Q2(2,1)+2.*Q1(1, ...
  1).*Q2(4,1))))+(-4).*ai(2,1).*(aj(3,1).*((-2).*(Q1(1,1).*Q1( ...
  3,1)+Q1(2,1).*Q1(4,1)).*Q2(1,1)+2.*((-1).*Q1(2,1).*Q1(3,1)+ ...
  Q1(1,1).*Q1(4,1)).*Q2(2,1)+(Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1( ...
  3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1))+aj(1,1).*(Q1(1,1).^2.* ...
  Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).* ...
  Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3,1)+(-1).*Q1(3,1).*Q2(4,1) ...
  )+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1)))+aj(2,1).* ...
  (Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2,1)+(-1).*(Q1(3,1).^2+ ...
  Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).*Q1(4,1).*Q2(3,1)+2.*Q1( ...
  3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4, ...
  1))))).*wi(1)+(4.*ai(3,1).*(aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+( ...
  -1).*Q1(2,1).^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2(1,1)+Q1(4,1) ...
  .^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).*Q1(2,1).*Q1( ...
  4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1) ...
  ))+aj(2,1).*(2.*(Q1(1,1).*Q1(3,1)+(-1).*Q1(2,1).*Q1(4,1)).* ...
  Q2(2,1)+(-2).*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3,1)+( ...
  (-1).*Q1(1,1).^2+Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).* ...
  Q2(4,1))+aj(1,1).*((-2).*Q1(2,1).*Q1(4,1).*Q2(1,1)+(-1).*Q1( ...
  1,1).^2.*Q2(3,1)+Q1(2,1).^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4, ...
  1).^2).*Q2(3,1)+2.*Q1(3,1).*Q1(4,1).*Q2(4,1)+2.*Q1(1,1).*( ...
  Q1(3,1).*Q2(1,1)+Q1(2,1).*Q2(4,1))))+4.*ai(1,1).*(aj(3,1).*( ...
  (-2).*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1)).*Q2(1,1)+2.*((-1) ...
  .*Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).*Q2(2,1)+(Q1(1,1).^2+ ...
  Q1(2,1).^2+(-1).*Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1))+aj( ...
  1,1).*(Q1(1,1).^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*(Q1(3, ...
  1).^2+Q1(4,1).^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3,1)+( ...
  -1).*Q1(3,1).*Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1) ...
  .*Q2(4,1)))+aj(2,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2, ...
  1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).* ...
  Q1(4,1).*Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).* ...
  Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wi(2)+(4.*ai(2,1).*((-1).*aj( ...
  3,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(-1).* ...
  Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4,1) ...
  .*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1(2, ...
  1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+aj(1,1).*((-2).*Q1(1,1).*Q1( ...
  3,1).*Q2(1,1)+2.*Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(3, ...
  1)+(-1).*Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4, ...
  1).^2.*Q2(3,1)+(-2).*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).* ...
  Q2(4,1))+aj(2,1).*(2.*((-1).*Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4, ...
  1)).*Q2(2,1)+2.*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3,1) ...
  +(Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2).* ...
  Q2(4,1)))+4.*ai(1,1).*(aj(3,1).*((-1).*Q1(1,1).^2.*Q2(2,1)+( ...
  -1).*Q1(3,1).^2.*Q2(2,1)+(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+ ...
  Q1(3,1).*((-2).*Q1(4,1).*Q2(1,1)+2.*Q1(2,1).*Q2(3,1))+2.*Q1( ...
  1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(1,1).*(2.*(Q1( ...
  2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).*Q2(1,1)+2.*((-1).*Q1(1,1).* ...
  Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3,1)+((-1).*Q1(1,1).^2+Q1(2,1) ...
  .^2+(-1).*Q1(3,1).^2+Q1(4,1).^2).*Q2(4,1))+aj(2,1).*(2.*Q1( ...
  1,1).*Q1(4,1).*Q2(2,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1) ...
  .^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1)+2.*Q1(3, ...
  1).*Q1(4,1).*Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1( ...
  1,1).*Q2(4,1))))).*wi(3)+4.*(ai(1,1).*(aj(2,1).*(Q1(1,1) ...
  .^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(-1).*Q1(3,1).^2.*Q2( ...
  1,1)+Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4,1).*Q2(2,1)+(-2).* ...
  Q1(2,1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1( ...
  3,1).*Q2(3,1)))+aj(3,1).*(Q1(1,1).*((-2).*Q1(3,1).*Q2(2,1)+ ...
  2.*Q1(2,1).*Q2(3,1))+2.*Q1(4,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).* ...
  Q2(3,1))+(Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4, ...
  1).^2).*Q2(4,1)))+ai(2,1).*(aj(2,1).*((-1).*Q1(1,1).^2.*Q2( ...
  2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+(Q1(2,1).^2+Q1(4,1).^2).*Q2( ...
  2,1)+Q1(3,1).*((-2).*Q1(4,1).*Q2(1,1)+2.*Q1(2,1).*Q2(3,1))+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(3,1).*(( ...
  -2).*Q1(1,1).*Q1(4,1).*Q2(2,1)+(-1).*Q1(1,1).^2.*Q2(3,1)+Q1( ...
  2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.*Q2(3, ...
  1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+Q1(2,1).*((-2).*Q1(3,1).* ...
  Q2(2,1)+2.*Q1(1,1).*Q2(4,1))))+ai(3,1).*(aj(2,1).*(2.*Q1(2, ...
  1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+2.*Q1(1,1).*(Q1(3,1) ...
  .*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1))+((-1).*Q1(1,1).^2+(-1).* ...
  Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(3,1))+aj(3,1).*(Q1(1, ...
  1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2,1)+(-1).*(Q1(3,1).^2+Q1(4,1) ...
  .^2).*Q2(2,1)+Q1(1,1).*((-2).*Q1(4,1).*Q2(3,1)+2.*Q1(3,1).* ...
  Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))) ...
  .*wj(1)+(-4).*(ai(2,1).*(aj(1,1).*((-1).*Q1(1,1).^2.*Q2(2,1) ...
  +(-1).*Q1(3,1).^2.*Q2(2,1)+(Q1(2,1).^2+Q1(4,1).^2).*Q2(2,1)+ ...
  Q1(3,1).*((-2).*Q1(4,1).*Q2(1,1)+2.*Q1(2,1).*Q2(3,1))+2.*Q1( ...
  1,1).*(Q1(2,1).*Q2(1,1)+Q1(4,1).*Q2(3,1)))+aj(3,1).*(Q1(2,1) ...
  .*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(1,1).*Q2(3,1))+(-2).*Q1(4,1) ...
  .*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+(Q1(1,1).^2+(-1).*Q1( ...
  2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1)))+ai(1,1).*( ...
  aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(-1) ...
  .*Q1(3,1).^2.*Q2(1,1)+Q1(4,1).^2.*Q2(1,1)+2.*Q1(3,1).*Q1(4, ...
  1).*Q2(2,1)+(-2).*Q1(2,1).*Q1(4,1).*Q2(3,1)+2.*Q1(1,1).*(Q1( ...
  2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1)))+aj(3,1).*(2.*Q1(2,1).*Q1(4, ...
  1).*Q2(1,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2(3,1)+( ...
  -1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+(-2).*Q1(3,1).* ...
  Q1(4,1).*Q2(4,1)+(-2).*Q1(1,1).*(Q1(3,1).*Q2(1,1)+Q1(2,1).* ...
  Q2(4,1))))+ai(3,1).*(aj(1,1).*(2.*Q1(2,1).*(Q1(4,1).*Q2(1,1) ...
  +Q1(3,1).*Q2(2,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(1,1)+(-1).*Q1(4, ...
  1).*Q2(2,1))+((-1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+ ...
  Q1(4,1).^2).*Q2(3,1))+aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+Q1(2,1) ...
  .^2.*Q2(1,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(1,1)+2.*Q1(2, ...
  1).*(Q1(4,1).*Q2(3,1)+(-1).*Q1(3,1).*Q2(4,1))+2.*Q1(1,1).*( ...
  Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wj(2)+4.*(ai(2,1).*( ...
  aj(2,1).*(Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(1,1).*Q2(3, ...
  1))+(-2).*Q1(4,1).*(Q1(1,1).*Q2(1,1)+Q1(3,1).*Q2(3,1))+(Q1( ...
  1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4, ...
  1))+aj(1,1).*(2.*Q1(1,1).*Q1(4,1).*Q2(2,1)+Q1(1,1).^2.*Q2(3, ...
  1)+(-1).*Q1(2,1).^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).* ...
  Q2(3,1)+2.*Q1(3,1).*Q1(4,1).*Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).* ...
  Q2(2,1)+(-1).*Q1(1,1).*Q2(4,1))))+ai(1,1).*(aj(1,1).*(2.*Q1( ...
  1,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(2,1).*Q2(3,1))+(-2).*Q1(4, ...
  1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+((-1).*Q1(1,1).^2+ ...
  Q1(2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1))+aj(2,1).*( ...
  2.*Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2, ...
  1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.*Q2(3,1) ...
  +(-2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+(-2).*Q1(1,1).*(Q1(3,1).* ...
  Q2(1,1)+Q1(2,1).*Q2(4,1))))+ai(3,1).*(aj(2,1).*(Q1(1,1).^2.* ...
  Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).* ...
  Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3,1)+(-1).*Q1(3,1).*Q2(4,1) ...
  )+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1)))+(-1).*aj( ...
  1,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2,1)+(-1).*(Q1(3, ...
  1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).*Q1(4,1).*Q2(3,1)+ ...
  2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).* ...
  Q2(4,1))))).*wj(3)),(1/2).*((4.*ai(3,1).*(aj(2,1).*((-2).*( ...
  Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).*Q2(1,1)+2.*(Q1(1,1).*Q1( ...
  2,1)+(-1).*Q1(3,1).*Q1(4,1)).*Q2(3,1)+(Q1(1,1).^2+(-1).*Q1( ...
  2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1))+aj(1,1).*(2.* ...
  Q1(1,1).*Q1(4,1).*Q2(2,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1) ...
  .^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1)+2.*Q1(3, ...
  1).*Q1(4,1).*Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1( ...
  1,1).*Q2(4,1)))+(-1).*aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).* ...
  Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))+4.*ai(2,1) ...
  .*(aj(3,1).*(2.*((-1).*Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).* ...
  Q2(1,1)+2.*(Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1)).*Q2(2,1)+(( ...
  -1).*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2( ...
  4,1))+(-1).*aj(2,1).*(Q1(1,1).^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1, ...
  1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4, ...
  1).*Q2(3,1)+(-1).*Q1(3,1).*Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).* ...
  Q2(3,1)+Q1(4,1).*Q2(4,1)))+aj(1,1).*(Q1(1,1).^2.*Q2(2,1)+Q1( ...
  2,1).^2.*Q2(2,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1( ...
  1,1).*((-2).*Q1(4,1).*Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2, ...
  1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wi(1)+(4.*ai(3, ...
  1).*(aj(1,1).*(2.*((-1).*Q1(1,1).*Q1(3,1)+Q1(2,1).*Q1(4,1)) ...
  .*Q2(2,1)+2.*(Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3,1)+( ...
  Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2).* ...
  Q2(4,1))+aj(2,1).*((-2).*Q1(2,1).*Q1(4,1).*Q2(1,1)+(-1).*Q1( ...
  1,1).^2.*Q2(3,1)+Q1(2,1).^2.*Q2(3,1)+(Q1(3,1).^2+(-1).*Q1(4, ...
  1).^2).*Q2(3,1)+2.*Q1(3,1).*Q1(4,1).*Q2(4,1)+2.*Q1(1,1).*( ...
  Q1(3,1).*Q2(1,1)+Q1(2,1).*Q2(4,1)))+aj(3,1).*((-2).*Q1(3,1) ...
  .*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(2,1)+(-1).*Q1(2,1).^2.*Q2( ...
  2,1)+(-1).*Q1(3,1).^2.*Q2(2,1)+Q1(4,1).^2.*Q2(2,1)+(-2).*Q1( ...
  2,1).*Q1(4,1).*Q2(4,1)+Q1(1,1).*((-2).*Q1(2,1).*Q2(1,1)+2.* ...
  Q1(3,1).*Q2(4,1))))+4.*ai(1,1).*(aj(3,1).*(2.*(Q1(2,1).*Q1( ...
  3,1)+(-1).*Q1(1,1).*Q1(4,1)).*Q2(1,1)+(-2).*(Q1(1,1).*Q1(3, ...
  1)+Q1(2,1).*Q1(4,1)).*Q2(2,1)+(Q1(1,1).^2+Q1(2,1).^2+(-1).* ...
  Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1))+aj(2,1).*(Q1(1,1) ...
  .^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*(Q1(3,1).^2+Q1(4,1) ...
  .^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3,1)+(-1).*Q1(3,1).* ...
  Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1)))+( ...
  -1).*aj(1,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2,1)+(-1) ...
  .*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*((-2).*Q1(4,1).* ...
  Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).*Q2(3,1)+ ...
  Q1(4,1).*Q2(4,1))))).*wi(2)+(4.*ai(2,1).*(aj(1,1).*(2.*(Q1( ...
  1,1).*Q1(3,1)+(-1).*Q1(2,1).*Q1(4,1)).*Q2(2,1)+(-2).*(Q1(1, ...
  1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3,1)+((-1).*Q1(1,1).^2+Q1( ...
  2,1).^2+Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1))+aj(2,1).*(2.* ...
  Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1) ...
  .^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+(-2).*Q1(1,1).*(Q1(3,1).*Q2( ...
  1,1)+Q1(2,1).*Q2(4,1)))+aj(3,1).*(2.*Q1(3,1).*Q1(4,1).*Q2(1, ...
  1)+(-1).*Q1(1,1).^2.*Q2(2,1)+Q1(3,1).^2.*Q2(2,1)+(Q1(2,1) ...
  .^2+(-1).*Q1(4,1).^2).*Q2(2,1)+2.*Q1(2,1).*Q1(4,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+(-1).*Q1(3,1).*Q2(4,1))))+4.* ...
  ai(1,1).*(aj(2,1).*(2.*(Q1(2,1).*Q1(3,1)+Q1(1,1).*Q1(4,1)).* ...
  Q2(1,1)+2.*((-1).*Q1(1,1).*Q1(2,1)+Q1(3,1).*Q1(4,1)).*Q2(3, ...
  1)+((-1).*Q1(1,1).^2+Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1).^2) ...
  .*Q2(4,1))+aj(1,1).*((-2).*Q1(1,1).*Q1(4,1).*Q2(2,1)+(-1).* ...
  Q1(1,1).^2.*Q2(3,1)+Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.* ...
  Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+ ...
  Q1(2,1).*((-2).*Q1(3,1).*Q2(2,1)+2.*Q1(1,1).*Q2(4,1)))+aj(3, ...
  1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+(Q1(3,1) ...
  .^2+(-1).*Q1(4,1).^2).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(2, ...
  1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(2, ...
  1)+Q1(4,1).*Q2(4,1))))).*wi(3)+4.*(ai(1,1).*(aj(3,1).*(2.* ...
  Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1) ...
  .^2.*Q2(3,1)+(-1).*Q1(3,1).^2.*Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+(-2).*Q1(1,1).*(Q1(3,1).*Q2( ...
  1,1)+Q1(2,1).*Q2(4,1)))+aj(2,1).*((-2).*Q1(3,1).*Q1(4,1).* ...
  Q2(1,1)+Q1(1,1).^2.*Q2(2,1)+(-1).*Q1(2,1).^2.*Q2(2,1)+(-1).* ...
  Q1(3,1).^2.*Q2(2,1)+Q1(4,1).^2.*Q2(2,1)+(-2).*Q1(2,1).*Q1(4, ...
  1).*Q2(4,1)+Q1(1,1).*((-2).*Q1(2,1).*Q2(1,1)+2.*Q1(3,1).*Q2( ...
  4,1))))+ai(2,1).*(aj(3,1).*(Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1) ...
  +2.*Q1(1,1).*Q2(3,1))+(-2).*Q1(4,1).*(Q1(1,1).*Q2(1,1)+Q1(3, ...
  1).*Q2(3,1))+(Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+(-1).* ...
  Q1(4,1).^2).*Q2(4,1))+aj(2,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).* ...
  Q1(2,1).^2.*Q2(1,1)+(Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+( ...
  -2).*Q1(3,1).*Q1(4,1).*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+ ...
  2.*Q1(1,1).*(Q1(2,1).*Q2(2,1)+Q1(4,1).*Q2(4,1))))+ai(3,1).*( ...
  aj(2,1).*(2.*Q1(1,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+ ...
  Q1(2,1).*((-2).*Q1(3,1).*Q2(1,1)+2.*Q1(4,1).*Q2(2,1))+((-1) ...
  .*Q1(1,1).^2+(-1).*Q1(2,1).^2+Q1(3,1).^2+Q1(4,1).^2).*Q2(4, ...
  1))+aj(3,1).*(Q1(1,1).^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).* ...
  (Q1(3,1).^2+Q1(4,1).^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3, ...
  1)+(-1).*Q1(3,1).*Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1( ...
  4,1).*Q2(4,1))))).*wj(1)+4.*(ai(1,1).*(aj(3,1).*(Q1(1,1).*(( ...
  -2).*Q1(3,1).*Q2(2,1)+2.*Q1(2,1).*Q2(3,1))+2.*Q1(4,1).*(Q1( ...
  2,1).*Q2(2,1)+Q1(3,1).*Q2(3,1))+(Q1(1,1).^2+(-1).*Q1(2,1) ...
  .^2+(-1).*Q1(3,1).^2+Q1(4,1).^2).*Q2(4,1))+aj(1,1).*(2.*Q1( ...
  3,1).*Q1(4,1).*Q2(1,1)+(-1).*Q1(1,1).^2.*Q2(2,1)+Q1(3,1) ...
  .^2.*Q2(2,1)+(Q1(2,1).^2+(-1).*Q1(4,1).^2).*Q2(2,1)+2.*Q1(2, ...
  1).*Q1(4,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(2,1).*Q2(1,1)+(-1).*Q1( ...
  3,1).*Q2(4,1))))+(-1).*ai(2,1).*(aj(3,1).*(2.*Q1(1,1).*Q1(4, ...
  1).*Q2(2,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2(3,1)+( ...
  Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1)+2.*Q1(3,1).*Q1(4,1).* ...
  Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(1,1).*Q2(4,1) ...
  ))+aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+(-1).*Q1(2,1).^2.*Q2(1,1)+( ...
  Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(1,1)+(-2).*Q1(3,1).*Q1(4,1) ...
  .*Q2(2,1)+2.*Q1(2,1).*Q1(3,1).*Q2(4,1)+2.*Q1(1,1).*(Q1(2,1) ...
  .*Q2(2,1)+Q1(4,1).*Q2(4,1))))+ai(3,1).*(aj(1,1).*((-2).*Q1( ...
  1,1).*(Q1(4,1).*Q2(1,1)+Q1(3,1).*Q2(2,1))+2.*Q1(2,1).*(Q1(3, ...
  1).*Q2(1,1)+(-1).*Q1(4,1).*Q2(2,1))+(Q1(1,1).^2+Q1(2,1).^2+( ...
  -1).*Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(4,1))+aj(3,1).*(Q1(1, ...
  1).^2.*Q2(2,1)+Q1(2,1).^2.*Q2(2,1)+(-1).*(Q1(3,1).^2+Q1(4,1) ...
  .^2).*Q2(2,1)+Q1(1,1).*((-2).*Q1(4,1).*Q2(3,1)+2.*Q1(3,1).* ...
  Q2(4,1))+2.*Q1(2,1).*(Q1(3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))) ...
  .*wj(2)+(-4).*((-1).*ai(2,1).*(aj(1,1).*(2.*Q1(2,1).*(Q1(3, ...
  1).*Q2(1,1)+(-1).*Q1(1,1).*Q2(3,1))+2.*Q1(4,1).*(Q1(1,1).* ...
  Q2(1,1)+Q1(3,1).*Q2(3,1))+((-1).*Q1(1,1).^2+Q1(2,1).^2+(-1) ...
  .*Q1(3,1).^2+Q1(4,1).^2).*Q2(4,1))+aj(2,1).*(2.*Q1(1,1).*Q1( ...
  4,1).*Q2(2,1)+Q1(1,1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2(3,1)+ ...
  (Q1(3,1).^2+(-1).*Q1(4,1).^2).*Q2(3,1)+2.*Q1(3,1).*Q1(4,1).* ...
  Q2(4,1)+2.*Q1(2,1).*(Q1(3,1).*Q2(2,1)+(-1).*Q1(1,1).*Q2(4,1) ...
  )))+ai(1,1).*(aj(2,1).*(Q1(1,1).*((-2).*Q1(3,1).*Q2(2,1)+2.* ...
  Q1(2,1).*Q2(3,1))+2.*Q1(4,1).*(Q1(2,1).*Q2(2,1)+Q1(3,1).*Q2( ...
  3,1))+(Q1(1,1).^2+(-1).*Q1(2,1).^2+(-1).*Q1(3,1).^2+Q1(4,1) ...
  .^2).*Q2(4,1))+aj(1,1).*(2.*Q1(2,1).*Q1(4,1).*Q2(1,1)+Q1(1, ...
  1).^2.*Q2(3,1)+(-1).*Q1(2,1).^2.*Q2(3,1)+(-1).*Q1(3,1).^2.* ...
  Q2(3,1)+Q1(4,1).^2.*Q2(3,1)+(-2).*Q1(3,1).*Q1(4,1).*Q2(4,1)+ ...
  (-2).*Q1(1,1).*(Q1(3,1).*Q2(1,1)+Q1(2,1).*Q2(4,1))))+ai(3,1) ...
  .*(aj(1,1).*(Q1(1,1).^2.*Q2(1,1)+Q1(2,1).^2.*Q2(1,1)+(-1).*( ...
  Q1(3,1).^2+Q1(4,1).^2).*Q2(1,1)+2.*Q1(2,1).*(Q1(4,1).*Q2(3, ...
  1)+(-1).*Q1(3,1).*Q2(4,1))+2.*Q1(1,1).*(Q1(3,1).*Q2(3,1)+Q1( ...
  4,1).*Q2(4,1)))+aj(2,1).*(Q1(1,1).^2.*Q2(2,1)+Q1(2,1).^2.* ...
  Q2(2,1)+(-1).*(Q1(3,1).^2+Q1(4,1).^2).*Q2(2,1)+Q1(1,1).*(( ...
  -2).*Q1(4,1).*Q2(3,1)+2.*Q1(3,1).*Q2(4,1))+2.*Q1(2,1).*(Q1( ...
  3,1).*Q2(3,1)+Q1(4,1).*Q2(4,1))))).*wj(3))];
    
    
    Cq_i(i,:) = CqB1*GB1;
    Cq_j(i,:) = CqB2*GB2;
    
    Cqf(i,1) = -(CdqqpdqB1*GB1*wi + CdqqpdqB2*GB2*wj);
end